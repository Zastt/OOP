# üß™ Laboratory Work 1: Messaging System Design
**–í–∞—Ä—ñ–∞–Ω—Ç 10: Moderation & Reporting** **–í–∏–∫–æ–Ω–∞–≤:** –Ø—Ü–µ–Ω–∫–æ –ú–∏–∫–æ–ª–∞ –í–∞—Å–∏–ª—å–æ–≤–∏—á  
**–ì—Ä—É–ø–∞:** –ë-121-24-3 –ü–Ü  

---

## üéØ –ú–µ—Ç–∞ —Ä–æ–±–æ—Ç–∏
- –ü—Ä–æ–µ–∫—Ç—É–≤–∞–Ω–Ω—è –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏ —Å–∏—Å—Ç–µ–º–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –ø–µ—Ä–µ–¥ –ø–æ—á–∞—Ç–∫–æ–º —Ä–æ–∑—Ä–æ–±–∫–∏.
- –†–æ–∑–ø–æ–¥—ñ–ª –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ—Å—Ç—ñ –º—ñ–∂ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏.
- –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –¥—ñ–∞–≥—Ä–∞–º Component, Sequence —Ç–∞ State –¥–ª—è –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—ó –ª–æ–≥—ñ–∫–∏.
- –î–æ–∫—É–º–µ–Ω—Ç—É–≤–∞–Ω–Ω—è –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–Ω–∏—Ö —Ä—ñ—à–µ–Ω—å (ADR).

---

## üß† –ö–æ–Ω—Ç–µ–∫—Å—Ç
–ü—Ä–æ–µ–∫—Ç—É–≤–∞–Ω–Ω—è –º–µ—Å–µ–Ω–¥–∂–µ—Ä–∞ –∑ —Ñ–æ–∫—É—Å–æ–º –Ω–∞ **–º–æ–¥–µ—Ä–∞—Ü—ñ—é –∫–æ–Ω—Ç–µ–Ω—Ç—É**. –°–∏—Å—Ç–µ–º–∞ –¥–æ–∑–≤–æ–ª—è—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º –Ω–∞–¥—Å–∏–ª–∞—Ç–∏ —Å–∫–∞—Ä–≥–∏ –Ω–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, –∞ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞–º ‚Äî –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ —ó—Ö —Ç–∞ –ø—Ä–∏—Ö–æ–≤—É–≤–∞—Ç–∏ –ø–æ—Ä—É—à–µ–Ω–Ω—è.

---

## üß± –ß–∞—Å—Ç–∏–Ω–∞ 1 ‚Äî Component Diagram
–¶—è –¥—ñ–∞–≥—Ä–∞–º–∞ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å–∏—Å—Ç–µ–º–∏. –ú–∏ –≤–∏–¥—ñ–ª—è—î–º–æ –æ–∫—Ä–µ–º–∏–π —Å–µ—Ä–≤—ñ—Å –º–æ–¥–µ—Ä–∞—Ü—ñ—ó, —â–æ–± –Ω–µ –ø–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏ –æ—Å–Ω–æ–≤–Ω–∏–π —Å–µ—Ä–≤—ñ—Å –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ—é –ª–æ–≥—ñ–∫–æ—é.

```mermaid
graph TD
    Client[User Client] -->|1. Report Message| API[Backend API Gateway]
    API --> MS[Message Service]
    API --> ModService[Moderation Service]
    
    MS --> MSG_DB[(Messages DB)]
    ModService --> Rep_DB[(Reports & Audit DB)]
    
    AdminPanel[Moderator Dashboard] -->|2. Review & Action| ModService
    ModService -.->|3. Update Visibility| MS
    
    subgraph Storage Layer
    MSG_DB
    Rep_DB
    end
```
üîÅ –ß–∞—Å—Ç–∏–Ω–∞ 2 ‚Äî Sequence Diagram
–°—Ü–µ–Ω–∞—Ä—ñ–π: –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –ê –Ω–∞–¥—Å–∏–ª–∞—î —Å–∫–∞—Ä–≥—É –Ω–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è. –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä –æ—Ç—Ä–∏–º—É—î —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è, –ø–µ—Ä–µ–≤—ñ—Ä—è—î –∫–æ–Ω—Ç–µ–Ω—Ç —ñ –ø—Ä–∏—Ö–æ–≤—É—î –π–æ–≥–æ.
```mermaid
sequenceDiagram
    participant A as User A (Reporter)
    participant API as Backend API
    participant Mod as Moderation Service
    participant DB as Reports DB
    participant M as Moderator (Admin Panel)
    participant MSG as Message Service

    A->>API: POST /messages/{id}/report (Reason)
    API->>Mod: createReport(message_id, user_id, reason)
    Mod->>DB: saveReport(status: PENDING)
    Mod-->>API: 202 Accepted
    API-->>A: Thank you for your report

    Note over M, Mod: Moderator logs into Dashboard
    
    M->>Mod: GET /pending-reports
    Mod-->>M: List of reports
    
    M->>Mod: POST /action (HIDDEN, message_id)
    Mod->>MSG: updateMessageStatus(id, HIDDEN)
    Mod->>DB: updateReport(status: RESOLVED)
    
    Note right of MSG: Message is now filtered <br/>out from user feeds
```
üîÑ –ß–∞—Å—Ç–∏–Ω–∞ 3 ‚Äî State Diagram
–û–ø–∏—Å –∂–∏—Ç—Ç—î–≤–æ–≥–æ —Ü–∏–∫–ª—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ –º–æ–¥–µ—Ä–∞—Ü—ñ—ó. –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –º–æ–∂–µ –±—É—Ç–∏ –∞–∫—Ç–∏–≤–Ω–∏–º, –ø—ñ–¥ –ø–µ—Ä–µ–≤—ñ—Ä–∫–æ—é –∞–±–æ –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏–º/–≤–∏–¥–∞–ª–µ–Ω–∏–º.
```mermaid
stateDiagram-v2
    [*] --> Active
    Active --> Reported : User_reports
    Reported --> UnderReview : Mod_opens
    
    UnderReview --> Active : Dismissed
    UnderReview --> Hidden : Action_Hide
    UnderReview --> Deleted : Action_Delete
    
    Hidden --> Active : Restore
    
    Active --> [*]
    Hidden --> [*]
    Deleted --> [*]
```
üìö –ß–∞—Å—Ç–∏–Ω–∞ 4 ‚Äî Architecture Decision Record (ADR)
ADR-010: –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è "Soft Delete" —Ç–∞ —Å—Ç–∞—Ç—É—Å—ñ–≤ –≤–∏–¥–∏–º–æ—Å—Ç—ñ –¥–ª—è –º–æ–¥–µ—Ä–∞—Ü—ñ—ó
```markdown
Status
Accepted

Context
–ö–æ–ª–∏ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä –≤–∏—Ä—ñ—à—É—î, —â–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø–æ—Ä—É—à—É—î –ø—Ä–∞–≤–∏–ª–∞ —Å–ø—ñ–ª—å–Ω–æ—Ç–∏, –Ω–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–±—Ä–∞—Ç–∏: –≤–∏–¥–∞–ª—è—Ç–∏ –¥–∞–Ω—ñ —Ñ—ñ–∑–∏—á–Ω–æ —á–∏ –ø—Ä–æ—Å—Ç–æ –ø—Ä–∏—Ö–æ–≤—É–≤–∞—Ç–∏ —ó—Ö. –°–∏—Å—Ç–µ–º–∞ –ø–æ–≤–∏–Ω–Ω–∞ –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –ø—Ä–æ–∑–æ—Ä—ñ—Å—Ç—å, –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –∞–ø–µ–ª—è—Ü—ñ–π —Ç–∞ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ —ñ—Å—Ç–æ—Ä—ñ—é –¥—ñ–π –º–æ–¥–µ—Ä–∞—Ç–æ—Ä—ñ–≤.

Decision
–í–ø—Ä–æ–≤–∞–¥–∏—Ç–∏ –º–µ—Ö–∞–Ω—ñ–∑–º Soft Delete (–º'—è–∫–µ –≤–∏–¥–∞–ª–µ–Ω–Ω—è) —á–µ—Ä–µ–∑ –ø–æ–ª–µ visibility_status —É –±–∞–∑—ñ –¥–∞–Ω–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å.

–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, –ø–æ–∑–Ω–∞—á–µ–Ω—ñ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–æ–º, –æ—Ç—Ä–∏–º—É—é—Ç—å —Å—Ç–∞—Ç—É—Å HIDDEN_BY_MODERATOR.

–°–µ—Ä–≤—ñ—Å –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å (Message Service) –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Ñ—ñ–ª—å—Ç—Ä—É—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, –¥–µ —Å—Ç–∞—Ç—É—Å –Ω–µ —î ACTIVE, –¥–ª—è –∑–≤–∏—á–∞–π–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤.

–û–∫—Ä–µ–º–∏–π Audit Log –≤–µ–¥–µ—Ç—å—Å—è –≤ Moderation Service –¥–ª—è –∑–∞–ø–∏—Å—É —Ç–æ–≥–æ, —è–∫–∏–π –º–æ–¥–µ—Ä–∞—Ç–æ—Ä –≤–∏–∫–æ–Ω–∞–≤ –¥—ñ—é —Ç–∞ –∑ —è–∫–æ—ó –ø—Ä–∏—á–∏–Ω–∏.

Consequences
–í–∏—Å–æ–∫–∞ —Ü—ñ–ª—ñ—Å–Ω—ñ—Å—Ç—å –¥–∞–Ω–∏—Ö: –ö–æ–Ω—Ç–µ–Ω—Ç –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è –¥–æ—Å—Ç—É–ø–Ω–∏–º –¥–ª—è –∞–ø–µ–ª—è—Ü—ñ–π –∞–±–æ –∑–∞–ø–∏—Ç—ñ–≤ –ø—Ä–∞–≤–æ–æ—Ö–æ—Ä–æ–Ω–Ω–∏—Ö –æ—Ä–≥–∞–Ω—ñ–≤.

–ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å —Å–∫–∞—Å—É–≤–∞–Ω–Ω—è: –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä–∏ –º–æ–∂—É—Ç—å –ª–µ–≥–∫–æ –ø–æ–≤–µ—Ä–Ω—É—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, —è–∫—â–æ —Å—Ç–∞–ª–∞—Å—è –ø–æ–º–∏–ª–∫–∞.

–ü—ñ–¥–∑–≤—ñ—Ç–Ω—ñ—Å—Ç—å: –ö–æ–∂–Ω–∞ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞ –¥—ñ—è –∑–∞—Ñ—ñ–∫—Å–æ–≤–∞–Ω–∞.

–ù–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ —Å—Ö–æ–≤–∏—â–µ: "–í–∏–¥–∞–ª–µ–Ω—ñ" –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ–¥–æ–≤–∂—É—é—Ç—å –∑–∞–π–º–∞—Ç–∏ –º—ñ—Å—Ü–µ –≤ –æ—Å–Ω–æ–≤–Ω—ñ–π –±–∞–∑—ñ.

–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å: –ö–æ–∂–µ–Ω –∑–∞–ø–∏—Ç –Ω–∞ —á–∏—Ç–∞–Ω–Ω—è –º–∞—î —Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ —Å—Ç–∞—Ç—É—Å (–ø–æ—Ç—Ä—ñ–±–µ–Ω —ñ–Ω–¥–µ–∫—Å –Ω–∞ visibility_status).
```
